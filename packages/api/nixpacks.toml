# Railway Nixpacks configuration for API service
[phases.setup]
nixPkgs = ["nodejs_20", "pnpm"]

[phases.install]
cmds = [
  "echo 'ðŸ“¦ Installing dependencies...'",
  "cd /app",
  "pnpm install --frozen-lockfile --prefer-offline"
]

[phases.build]
cmds = [
  "echo 'ðŸ”¨ Building shared package...'",
  "cd /app/packages/shared && pnpm build",
  "echo 'ðŸ”¨ Building API...'",
  "cd /app/packages/api && pnpm build",
  "echo 'âœ… Build complete!'"
]

[start]
cmd = "cd packages/api && node dist/index.js"

[variables]
NODE_ENV = "production"
PORT = "3001"

# Health check configuration
[healthcheck]
path = "/health"
interval = 30
timeout = 10
